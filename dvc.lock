schema: '2.0'
stages:
  data_split:
    cmd: python src/stages/data_split.py --config params.yaml
    deps:
    - path: data/raw
      hash: md5
      md5: dbe1cfcf546b65bc2246f85aa14c5a21.dir
      size: 466888
      nfiles: 2
    - path: src/stages/data_split.py
      hash: md5
      md5: 1ec3f1454c2445627e5d55122da59725
      size: 1434
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          raw_data_dir: data/raw
          countries:
          - France
          - Spain
          feat_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
        data_split:
          test_size: 0.25
          processed_data_dir: data/processed
    outs:
    - path: data/processed
      hash: md5
      md5: c9f8d0f86f89503597e1e9db96a8193d.dir
      size: 722283
      nfiles: 4
  eval:
    cmd: python src/stages/eval.py --config=params.yaml
    deps:
    - path: data/processed
      hash: md5
      md5: c9f8d0f86f89503597e1e9db96a8193d.dir
      size: 722283
      nfiles: 4
    - path: models/clf-model.joblib
      hash: md5
      md5: caf0e9dd62b0af32f14ee51055c366be
      size: 1149004
    - path: src/stages/eval.py
      hash: md5
      md5: e402ec2f10cedbc6c02331cf13cd1147
      size: 2429
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          raw_data_dir: data/raw
          countries:
          - France
          - Spain
          feat_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
        data_split:
          test_size: 0.25
          processed_data_dir: data/processed
        train:
          model_type: xgboost
          model_dir: models
          model_path: models/clf-model.joblib
          params:
            n_estimators: 200
            max_depth: 20
    outs:
    - path: metrics.json
      hash: md5
      md5: 44ccfc38e85f2498d6b9145ad95f88ca
      size: 67
    - path: reports/feat_imp.csv
      hash: md5
      md5: cfaffb2ac5a05fb732973f972d7cf605
      size: 187
    - path: reports/figures/cm.png
      hash: md5
      md5: dbc59bb8fd1985ff7e29681c4024d64e
      size: 10493
  train:
    cmd: python src/stages/train.py --config=params.yaml
    deps:
    - path: data/processed
      hash: md5
      md5: c9f8d0f86f89503597e1e9db96a8193d.dir
      size: 722283
      nfiles: 4
    - path: src/stages/train.py
      hash: md5
      md5: f132766b0dffcabb612e354eb3d38a91
      size: 1945
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          raw_data_dir: data/raw
          countries:
          - France
          - Spain
          feat_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
        train:
          model_type: xgboost
          model_dir: models
          model_path: models/clf-model.joblib
          params:
            n_estimators: 200
            max_depth: 20
    outs:
    - path: models/clf-model.joblib
      hash: md5
      md5: caf0e9dd62b0af32f14ee51055c366be
      size: 1149004
  train_drift_detector:
    cmd: python src/stages/drift_detector.py --config=params.yaml
    deps:
    - path: data/processed
      hash: md5
      md5: c9f8d0f86f89503597e1e9db96a8193d.dir
      size: 722283
      nfiles: 4
    - path: models/clf-model.joblib
      hash: md5
      md5: caf0e9dd62b0af32f14ee51055c366be
      size: 1149004
    - path: src/stages/drift_detector.py
      hash: md5
      md5: bf0cdb21b655c79b138ca047676b93eb
      size: 1386
    params:
      params.yaml:
        base:
          project: bank_customer_churn
          raw_data_dir: data/raw
          countries:
          - France
          - Spain
          feat_cols:
          - CreditScore
          - Age
          - Tenure
          - Balance
          - NumOfProducts
          - HasCrCard
          - IsActiveMember
          - EstimatedSalary
          targ_col: Exited
          random_state: 42
        data_split:
          test_size: 0.25
          processed_data_dir: data/processed
        drift_detect:
          min_batch_size: 50
        train:
          model_type: xgboost
          model_dir: models
          model_path: models/clf-model.joblib
          params:
            n_estimators: 200
            max_depth: 20
    outs:
    - path: models/drift_detector
      hash: md5
      md5: e36ec6d39459eb6d32278a9c04ee83e3.dir
      size: 483726
      nfiles: 3
